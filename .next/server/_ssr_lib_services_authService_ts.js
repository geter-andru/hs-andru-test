"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "_ssr_lib_services_authService_ts";
exports.ids = ["_ssr_lib_services_authService_ts"];
exports.modules = {

/***/ "(ssr)/./lib/services/authService.ts":
/*!*************************************!*\
  !*** ./lib/services/authService.ts ***!
  \*************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   authService: () => (/* binding */ authService),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var js_cookie__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! js-cookie */ \"(ssr)/./node_modules/js-cookie/dist/js.cookie.mjs\");\n/* harmony import */ var _supabase_client__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../supabase/client */ \"(ssr)/./lib/supabase/client.ts\");\n// Enhanced Auth Service for Next.js Platform\n// Based on React SPA's authService.js patterns with Supabase integration\n\n\nclass AuthService {\n    constructor(){\n        this.session = null;\n        // Cookie names\n        this.TOKEN_COOKIE = 'hs_auth_token';\n        this.REFRESH_COOKIE = 'hs_refresh_token';\n        this.CUSTOMER_ID_COOKIE = 'hs_customer_id';\n        this.SESSION_COOKIE = 'hs_session';\n        if (AuthService.instance) {\n            return AuthService.instance;\n        }\n        AuthService.instance = this;\n        this.loadSessionFromStorage();\n    }\n    // Load session from cookies on initialization\n    loadSessionFromStorage() {\n        if (true) return;\n        try {\n            const sessionData = js_cookie__WEBPACK_IMPORTED_MODULE_0__[\"default\"].get(this.SESSION_COOKIE);\n            if (sessionData) {\n                this.session = JSON.parse(sessionData);\n                // Validate session hasn't expired\n                if (this.session && this.session.expiresAt < Date.now()) {\n                    this.clearSession();\n                }\n            }\n        } catch (error) {\n            console.warn('Failed to load session from storage:', error);\n            this.clearSession();\n        }\n    }\n    // Save session to cookies\n    saveSessionToStorage(session) {\n        if (true) return;\n        try {\n            js_cookie__WEBPACK_IMPORTED_MODULE_0__[\"default\"].set(this.TOKEN_COOKIE, session.accessToken, {\n                expires: 1\n            });\n            js_cookie__WEBPACK_IMPORTED_MODULE_0__[\"default\"].set(this.REFRESH_COOKIE, session.refreshToken, {\n                expires: 7\n            });\n            js_cookie__WEBPACK_IMPORTED_MODULE_0__[\"default\"].set(this.CUSTOMER_ID_COOKIE, session.customerId, {\n                expires: 7\n            });\n            js_cookie__WEBPACK_IMPORTED_MODULE_0__[\"default\"].set(this.SESSION_COOKIE, JSON.stringify(session), {\n                expires: 1\n            });\n        } catch (error) {\n            console.error('Failed to save session to storage:', error);\n        }\n    }\n    // Clear session from cookies\n    clearSession() {\n        this.session = null;\n        if (true) return;\n        js_cookie__WEBPACK_IMPORTED_MODULE_0__[\"default\"].remove(this.TOKEN_COOKIE);\n        js_cookie__WEBPACK_IMPORTED_MODULE_0__[\"default\"].remove(this.REFRESH_COOKIE);\n        js_cookie__WEBPACK_IMPORTED_MODULE_0__[\"default\"].remove(this.CUSTOMER_ID_COOKIE);\n        js_cookie__WEBPACK_IMPORTED_MODULE_0__[\"default\"].remove(this.SESSION_COOKIE);\n    }\n    // Supabase authentication methods\n    async loginWithSupabase() {\n        try {\n            const supabaseUser = await (0,_supabase_client__WEBPACK_IMPORTED_MODULE_1__.getCurrentUser)();\n            if (!supabaseUser) {\n                return {\n                    success: false,\n                    error: 'No Supabase user found. Please sign in.'\n                };\n            }\n            // Create customer profile from Supabase user\n            const customer = {\n                id: 'SUPABASE_USER',\n                customerId: 'SUPABASE_USER',\n                name: supabaseUser.user_metadata?.full_name || supabaseUser.email || 'Supabase User',\n                customerName: supabaseUser.user_metadata?.full_name || supabaseUser.email || 'Supabase User',\n                email: supabaseUser.email || '',\n                company: supabaseUser.user_metadata?.company || 'Your Company',\n                status: 'active',\n                isAdmin: false,\n                demoMode: false,\n                hasPersonalizedICP: true,\n                hasDetailedAnalysis: true,\n                paymentStatus: 'Completed' // Supabase users get full access\n            };\n            // Create session\n            const session = {\n                customerId: 'SUPABASE_USER',\n                accessToken: 'supabase-auth',\n                refreshToken: `supabase_refresh_${Date.now()}`,\n                expiresAt: Date.now() + 24 * 60 * 60 * 1000,\n                customer\n            };\n            this.session = session;\n            this.saveSessionToStorage(session);\n            return {\n                success: true,\n                data: customer\n            };\n        } catch (error) {\n            return {\n                success: false,\n                error: 'Supabase authentication failed. Please try again.'\n            };\n        }\n    }\n    // Check if user is authenticated via Supabase\n    async isSupabaseAuthenticated() {\n        try {\n            const user = await (0,_supabase_client__WEBPACK_IMPORTED_MODULE_1__.getCurrentUser)();\n            return !!user;\n        } catch  {\n            return false;\n        }\n    }\n    // Enhanced login with multiple authentication patterns\n    async login(customerId, accessToken) {\n        try {\n            // Simulate API delay\n            await new Promise((resolve)=>setTimeout(resolve, 500));\n            const customer = this.getCustomerProfile(customerId);\n            if (!customer) {\n                return {\n                    success: false,\n                    error: 'Customer not found. Please check your Customer ID.'\n                };\n            }\n            // Validate admin access tokens\n            if (customer.isAdmin && accessToken) {\n                const validAdminTokens = [\n                    'admin-demo-token-2025',\n                    'test-token-123456'\n                ];\n                if (!validAdminTokens.includes(accessToken)) {\n                    return {\n                        success: false,\n                        error: 'Invalid admin access token.'\n                    };\n                }\n            }\n            // Create session\n            const session = {\n                customerId,\n                accessToken: accessToken || `token_${customerId}_${Date.now()}`,\n                refreshToken: `refresh_${customerId}_${Date.now()}`,\n                expiresAt: Date.now() + 24 * 60 * 60 * 1000,\n                customer\n            };\n            this.session = session;\n            this.saveSessionToStorage(session);\n            return {\n                success: true,\n                data: customer\n            };\n        } catch (error) {\n            return {\n                success: false,\n                error: 'Login failed. Please try again.'\n            };\n        }\n    }\n    // Logout and clear session\n    logout() {\n        this.clearSession();\n        if (false) {}\n    }\n    // Check if user is authenticated\n    isAuthenticated() {\n        if (!this.session) return false;\n        if (this.session.expiresAt < Date.now()) {\n            this.clearSession();\n            return false;\n        }\n        return true;\n    }\n    // Get current session\n    getCurrentSession() {\n        if (!this.isAuthenticated()) return null;\n        return this.session;\n    }\n    // Get current customer\n    getCurrentCustomer() {\n        const session = this.getCurrentSession();\n        return session?.customer || null;\n    }\n    // Get customer ID\n    getCustomerId() {\n        const session = this.getCurrentSession();\n        return session?.customerId;\n    }\n    // Get access token\n    getAccessToken() {\n        const session = this.getCurrentSession();\n        return session?.accessToken;\n    }\n    // Admin access checks\n    isAdmin() {\n        const customer = this.getCurrentCustomer();\n        return customer?.isAdmin === true;\n    }\n    hasAdminAccess() {\n        const customer = this.getCurrentCustomer();\n        return customer?.isAdmin === true && customer?.adminAccess === true;\n    }\n    // Payment status checks\n    hasCompletedPayment() {\n        const customer = this.getCurrentCustomer();\n        // Admin users always have access\n        if (customer?.isAdmin) return true;\n        return customer?.paymentStatus === 'Completed';\n    }\n    // Tool access validation\n    hasToolAccess(toolName) {\n        const customer = this.getCurrentCustomer();\n        if (!customer) return false;\n        // Admin users have access to all tools\n        if (customer.isAdmin) return true;\n        // Check payment status for regular users\n        if (!this.hasCompletedPayment()) return false;\n        // Tool-specific access logic\n        switch(toolName){\n            case 'icp':\n                return customer.hasPersonalizedICP || false;\n            case 'cost-calculator':\n                return true; // Available to all paid users\n            case 'business-case':\n                return customer.hasDetailedAnalysis || false;\n            default:\n                return false;\n        }\n    }\n    // Refresh authentication token\n    async refreshToken() {\n        if (!this.session) return false;\n        try {\n            // Simulate token refresh API call\n            const newToken = `refreshed_token_${this.session.customerId}_${Date.now()}`;\n            this.session.accessToken = newToken;\n            this.session.expiresAt = Date.now() + 24 * 60 * 60 * 1000;\n            this.saveSessionToStorage(this.session);\n            return true;\n        } catch (error) {\n            console.error('Failed to refresh token:', error);\n            this.clearSession();\n            return false;\n        }\n    }\n    // Session validation and extension\n    async validateSession() {\n        if (!this.session) return false;\n        // If session expires in less than 1 hour, try to refresh\n        const oneHour = 60 * 60 * 1000;\n        if (this.session.expiresAt - Date.now() < oneHour) {\n            return await this.refreshToken();\n        }\n        return true;\n    }\n    // Get customer profiles (mock data)\n    getCustomerProfile(customerId) {\n        const profiles = {\n            'CUST_2': {\n                id: 'CUST_2',\n                customerId: 'CUST_2',\n                name: 'John Demo',\n                customerName: 'John Demo',\n                email: 'john@example.com',\n                company: 'Demo Company',\n                status: 'active',\n                isAdmin: false,\n                demoMode: false,\n                hasPersonalizedICP: true,\n                hasDetailedAnalysis: false,\n                paymentStatus: 'Completed'\n            },\n            'CUST_4': {\n                id: 'CUST_4',\n                customerId: 'CUST_4',\n                name: 'Admin Demo',\n                customerName: 'Platform Administrator',\n                email: 'admin@example.com',\n                company: 'H&S Revenue Intelligence',\n                status: 'admin',\n                isAdmin: true,\n                demoMode: true,\n                hasPersonalizedICP: true,\n                hasDetailedAnalysis: true,\n                adminAccess: true,\n                paymentStatus: 'Completed'\n            },\n            'dru78DR9789SDF862': {\n                id: 'dru78DR9789SDF862',\n                customerId: 'dru78DR9789SDF862',\n                name: 'Geter',\n                customerName: 'Geter',\n                email: 'geter@hs-platform.com',\n                company: 'H&S Platform',\n                status: 'admin',\n                isAdmin: true,\n                demoMode: true,\n                hasPersonalizedICP: true,\n                hasDetailedAnalysis: true,\n                adminAccess: true,\n                paymentStatus: 'Completed'\n            },\n            'CUST_02': {\n                id: 'CUST_02',\n                customerId: 'CUST_02',\n                name: 'Test User',\n                customerName: 'Test User',\n                email: 'test@example.com',\n                company: 'Test Company',\n                status: 'test',\n                isAdmin: false,\n                demoMode: true,\n                hasPersonalizedICP: false,\n                hasDetailedAnalysis: false,\n                paymentStatus: 'Pending'\n            }\n        };\n        return profiles[customerId] || null;\n    }\n    // Development utilities\n    isDemoMode() {\n        const customer = this.getCurrentCustomer();\n        return customer?.demoMode === true;\n    }\n    getSessionInfo() {\n        return {\n            isAuthenticated: this.isAuthenticated(),\n            customerId: this.getCustomerId(),\n            isAdmin: this.isAdmin(),\n            hasAdminAccess: this.hasAdminAccess(),\n            hasCompletedPayment: this.hasCompletedPayment(),\n            isDemoMode: this.isDemoMode(),\n            sessionExpiresAt: this.session?.expiresAt,\n            sessionValid: this.session ? this.session.expiresAt > Date.now() : false\n        };\n    }\n    // Extract credentials from URL parameters\n    extractCredentials(searchParams) {\n        const customerId = searchParams.get('customerId') || '';\n        const accessToken = searchParams.get('token') || '';\n        if (!customerId || !accessToken) {\n            return null;\n        }\n        return {\n            customerId,\n            accessToken\n        };\n    }\n    // Validate credentials using existing authentication logic\n    async validateCredentials(customerId, accessToken) {\n        try {\n            // Use existing authentication method for admin users\n            if (customerId === 'dru78DR9789SDF862' && accessToken === 'admin-demo-token-2025') {\n                const adminData = await this.getAdminProfile();\n                return {\n                    valid: true,\n                    customerData: adminData\n                };\n            }\n            // For regular customers, implement proper validation\n            // This would need integration with actual customer database\n            return {\n                valid: false,\n                error: 'Customer validation not implemented for non-admin users'\n            };\n        } catch (error) {\n            return {\n                valid: false,\n                error: `Validation failed: ${error.message}`\n            };\n        }\n    }\n    // Generate session from validated credentials\n    async generateSession(customerId, customerData) {\n        const sessionData = {\n            customerId,\n            accessToken: `token_${Date.now()}`,\n            refreshToken: `refresh_${Date.now()}`,\n            expiresAt: Date.now() + 24 * 60 * 60 * 1000,\n            customer: customerData\n        };\n        this.session = sessionData;\n        this.saveSessionToStorage();\n        return sessionData;\n    }\n    // Refresh existing session\n    async refreshSession() {\n        if (this.session && this.session.expiresAt > Date.now()) {\n            this.session.expiresAt = Date.now() + 24 * 60 * 60 * 1000; // Extend by 24 hours\n            this.saveSessionToStorage();\n        }\n    }\n}\n// Export singleton instance\nconst authService = new AuthService();\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (authService);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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TUFBTSxFQUFFUixLQUFLQyxHQUFHLElBQUk7WUFDbENTLGNBQWMsQ0FBQyxRQUFRLEVBQUVWLEtBQUtDLEdBQUcsSUFBSTtZQUNyQ0YsV0FBV0MsS0FBS0MsR0FBRyxLQUFNLEtBQUssS0FBSyxLQUFLO1lBQ3hDZ0IsVUFBVW9EO1FBQ1o7UUFFQSxJQUFJLENBQUNqRixPQUFPLEdBQUdPO1FBQ2YsSUFBSSxDQUFDVyxvQkFBb0I7UUFFekIsT0FBT1g7SUFDVDtJQUVBLDJCQUEyQjtJQUMzQixNQUFNNkUsaUJBQWdDO1FBQ3BDLElBQUksSUFBSSxDQUFDcEYsT0FBTyxJQUFJLElBQUksQ0FBQ0EsT0FBTyxDQUFDVyxTQUFTLEdBQUdDLEtBQUtDLEdBQUcsSUFBSTtZQUN2RCxJQUFJLENBQUNiLE9BQU8sQ0FBQ1csU0FBUyxHQUFHQyxLQUFLQyxHQUFHLEtBQU0sS0FBSyxLQUFLLEtBQUssTUFBTyxxQkFBcUI7WUFDbEYsSUFBSSxDQUFDSyxvQkFBb0I7UUFDM0I7SUFDRjtBQUNGO0FBRUEsNEJBQTRCO0FBQ3JCLE1BQU1tRSxjQUFjLElBQUl0RixjQUFjO0FBQzdDLGlFQUFlc0YsV0FBV0EsRUFBQyIsInNvdXJjZXMiOlsiL1VzZXJzL2dldGVyL2FuZHJ1L2hzLWFuZHJ1LXRlc3QvbW9kZXJuLXBsYXRmb3JtL2xpYi9zZXJ2aWNlcy9hdXRoU2VydmljZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBFbmhhbmNlZCBBdXRoIFNlcnZpY2UgZm9yIE5leHQuanMgUGxhdGZvcm1cbi8vIEJhc2VkIG9uIFJlYWN0IFNQQSdzIGF1dGhTZXJ2aWNlLmpzIHBhdHRlcm5zIHdpdGggU3VwYWJhc2UgaW50ZWdyYXRpb25cblxuaW1wb3J0IENvb2tpZXMgZnJvbSAnanMtY29va2llJztcbmltcG9ydCB7IHN1cGFiYXNlLCBnZXRDdXJyZW50VXNlciBhcyBnZXRTdXBhYmFzZVVzZXIgfSBmcm9tICcuLi9zdXBhYmFzZS9jbGllbnQnO1xuXG5pbnRlcmZhY2UgQXV0aFNlc3Npb24ge1xuICBjdXN0b21lcklkOiBzdHJpbmc7XG4gIGFjY2Vzc1Rva2VuOiBzdHJpbmc7XG4gIHJlZnJlc2hUb2tlbjogc3RyaW5nO1xuICBleHBpcmVzQXQ6IG51bWJlcjtcbiAgY3VzdG9tZXI6IEN1c3RvbWVyUHJvZmlsZSB8IG51bGw7XG59XG5cbmludGVyZmFjZSBDdXN0b21lclByb2ZpbGUge1xuICBpZDogc3RyaW5nO1xuICBjdXN0b21lcklkOiBzdHJpbmc7XG4gIG5hbWU6IHN0cmluZztcbiAgY3VzdG9tZXJOYW1lOiBzdHJpbmc7XG4gIGVtYWlsOiBzdHJpbmc7XG4gIGNvbXBhbnk6IHN0cmluZztcbiAgc3RhdHVzOiBzdHJpbmc7XG4gIGlzQWRtaW4/OiBib29sZWFuO1xuICBkZW1vTW9kZT86IGJvb2xlYW47XG4gIGhhc1BlcnNvbmFsaXplZElDUD86IGJvb2xlYW47XG4gIGhhc0RldGFpbGVkQW5hbHlzaXM/OiBib29sZWFuO1xuICBhZG1pbkFjY2Vzcz86IGJvb2xlYW47XG4gIHBheW1lbnRTdGF0dXM/OiBzdHJpbmc7XG59XG5cbmNsYXNzIEF1dGhTZXJ2aWNlIHtcbiAgcHJpdmF0ZSBzdGF0aWMgaW5zdGFuY2U6IEF1dGhTZXJ2aWNlO1xuICBwcml2YXRlIHNlc3Npb246IEF1dGhTZXNzaW9uIHwgbnVsbCA9IG51bGw7XG4gIFxuICAvLyBDb29raWUgbmFtZXNcbiAgcHJpdmF0ZSByZWFkb25seSBUT0tFTl9DT09LSUUgPSAnaHNfYXV0aF90b2tlbic7XG4gIHByaXZhdGUgcmVhZG9ubHkgUkVGUkVTSF9DT09LSUUgPSAnaHNfcmVmcmVzaF90b2tlbic7XG4gIHByaXZhdGUgcmVhZG9ubHkgQ1VTVE9NRVJfSURfQ09PS0lFID0gJ2hzX2N1c3RvbWVyX2lkJztcbiAgcHJpdmF0ZSByZWFkb25seSBTRVNTSU9OX0NPT0tJRSA9ICdoc19zZXNzaW9uJztcblxuICBjb25zdHJ1Y3RvcigpIHtcbiAgICBpZiAoQXV0aFNlcnZpY2UuaW5zdGFuY2UpIHtcbiAgICAgIHJldHVybiBBdXRoU2VydmljZS5pbnN0YW5jZTtcbiAgICB9XG4gICAgQXV0aFNlcnZpY2UuaW5zdGFuY2UgPSB0aGlzO1xuICAgIHRoaXMubG9hZFNlc3Npb25Gcm9tU3RvcmFnZSgpO1xuICB9XG5cbiAgLy8gTG9hZCBzZXNzaW9uIGZyb20gY29va2llcyBvbiBpbml0aWFsaXphdGlvblxuICBwcml2YXRlIGxvYWRTZXNzaW9uRnJvbVN0b3JhZ2UoKTogdm9pZCB7XG4gICAgaWYgKHR5cGVvZiB3aW5kb3cgPT09ICd1bmRlZmluZWQnKSByZXR1cm47XG4gICAgXG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHNlc3Npb25EYXRhID0gQ29va2llcy5nZXQodGhpcy5TRVNTSU9OX0NPT0tJRSk7XG4gICAgICBpZiAoc2Vzc2lvbkRhdGEpIHtcbiAgICAgICAgdGhpcy5zZXNzaW9uID0gSlNPTi5wYXJzZShzZXNzaW9uRGF0YSk7XG4gICAgICAgIC8vIFZhbGlkYXRlIHNlc3Npb24gaGFzbid0IGV4cGlyZWRcbiAgICAgICAgaWYgKHRoaXMuc2Vzc2lvbiAmJiB0aGlzLnNlc3Npb24uZXhwaXJlc0F0IDwgRGF0ZS5ub3coKSkge1xuICAgICAgICAgIHRoaXMuY2xlYXJTZXNzaW9uKCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS53YXJuKCdGYWlsZWQgdG8gbG9hZCBzZXNzaW9uIGZyb20gc3RvcmFnZTonLCBlcnJvcik7XG4gICAgICB0aGlzLmNsZWFyU2Vzc2lvbigpO1xuICAgIH1cbiAgfVxuXG4gIC8vIFNhdmUgc2Vzc2lvbiB0byBjb29raWVzXG4gIHByaXZhdGUgc2F2ZVNlc3Npb25Ub1N0b3JhZ2Uoc2Vzc2lvbjogQXV0aFNlc3Npb24pOiB2b2lkIHtcbiAgICBpZiAodHlwZW9mIHdpbmRvdyA9PT0gJ3VuZGVmaW5lZCcpIHJldHVybjtcbiAgICBcbiAgICB0cnkge1xuICAgICAgQ29va2llcy5zZXQodGhpcy5UT0tFTl9DT09LSUUsIHNlc3Npb24uYWNjZXNzVG9rZW4sIHsgZXhwaXJlczogMSB9KTtcbiAgICAgIENvb2tpZXMuc2V0KHRoaXMuUkVGUkVTSF9DT09LSUUsIHNlc3Npb24ucmVmcmVzaFRva2VuLCB7IGV4cGlyZXM6IDcgfSk7XG4gICAgICBDb29raWVzLnNldCh0aGlzLkNVU1RPTUVSX0lEX0NPT0tJRSwgc2Vzc2lvbi5jdXN0b21lcklkLCB7IGV4cGlyZXM6IDcgfSk7XG4gICAgICBDb29raWVzLnNldCh0aGlzLlNFU1NJT05fQ09PS0lFLCBKU09OLnN0cmluZ2lmeShzZXNzaW9uKSwgeyBleHBpcmVzOiAxIH0pO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gc2F2ZSBzZXNzaW9uIHRvIHN0b3JhZ2U6JywgZXJyb3IpO1xuICAgIH1cbiAgfVxuXG4gIC8vIENsZWFyIHNlc3Npb24gZnJvbSBjb29raWVzXG4gIHByaXZhdGUgY2xlYXJTZXNzaW9uKCk6IHZvaWQge1xuICAgIHRoaXMuc2Vzc2lvbiA9IG51bGw7XG4gICAgaWYgKHR5cGVvZiB3aW5kb3cgPT09ICd1bmRlZmluZWQnKSByZXR1cm47XG4gICAgXG4gICAgQ29va2llcy5yZW1vdmUodGhpcy5UT0tFTl9DT09LSUUpO1xuICAgIENvb2tpZXMucmVtb3ZlKHRoaXMuUkVGUkVTSF9DT09LSUUpO1xuICAgIENvb2tpZXMucmVtb3ZlKHRoaXMuQ1VTVE9NRVJfSURfQ09PS0lFKTtcbiAgICBDb29raWVzLnJlbW92ZSh0aGlzLlNFU1NJT05fQ09PS0lFKTtcbiAgfVxuXG4gIC8vIFN1cGFiYXNlIGF1dGhlbnRpY2F0aW9uIG1ldGhvZHNcbiAgYXN5bmMgbG9naW5XaXRoU3VwYWJhc2UoKTogUHJvbWlzZTx7IHN1Y2Nlc3M6IGJvb2xlYW47IGRhdGE/OiBDdXN0b21lclByb2ZpbGU7IGVycm9yPzogc3RyaW5nIH0+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3Qgc3VwYWJhc2VVc2VyID0gYXdhaXQgZ2V0U3VwYWJhc2VVc2VyKCk7XG4gICAgICBpZiAoIXN1cGFiYXNlVXNlcikge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgIGVycm9yOiAnTm8gU3VwYWJhc2UgdXNlciBmb3VuZC4gUGxlYXNlIHNpZ24gaW4uJ1xuICAgICAgICB9O1xuICAgICAgfVxuXG4gICAgICAvLyBDcmVhdGUgY3VzdG9tZXIgcHJvZmlsZSBmcm9tIFN1cGFiYXNlIHVzZXJcbiAgICAgIGNvbnN0IGN1c3RvbWVyOiBDdXN0b21lclByb2ZpbGUgPSB7XG4gICAgICAgIGlkOiAnU1VQQUJBU0VfVVNFUicsXG4gICAgICAgIGN1c3RvbWVySWQ6ICdTVVBBQkFTRV9VU0VSJyxcbiAgICAgICAgbmFtZTogc3VwYWJhc2VVc2VyLnVzZXJfbWV0YWRhdGE/LmZ1bGxfbmFtZSB8fCBzdXBhYmFzZVVzZXIuZW1haWwgfHwgJ1N1cGFiYXNlIFVzZXInLFxuICAgICAgICBjdXN0b21lck5hbWU6IHN1cGFiYXNlVXNlci51c2VyX21ldGFkYXRhPy5mdWxsX25hbWUgfHwgc3VwYWJhc2VVc2VyLmVtYWlsIHx8ICdTdXBhYmFzZSBVc2VyJyxcbiAgICAgICAgZW1haWw6IHN1cGFiYXNlVXNlci5lbWFpbCB8fCAnJyxcbiAgICAgICAgY29tcGFueTogc3VwYWJhc2VVc2VyLnVzZXJfbWV0YWRhdGE/LmNvbXBhbnkgfHwgJ1lvdXIgQ29tcGFueScsXG4gICAgICAgIHN0YXR1czogJ2FjdGl2ZScsXG4gICAgICAgIGlzQWRtaW46IGZhbHNlLFxuICAgICAgICBkZW1vTW9kZTogZmFsc2UsXG4gICAgICAgIGhhc1BlcnNvbmFsaXplZElDUDogdHJ1ZSxcbiAgICAgICAgaGFzRGV0YWlsZWRBbmFseXNpczogdHJ1ZSxcbiAgICAgICAgcGF5bWVudFN0YXR1czogJ0NvbXBsZXRlZCcgLy8gU3VwYWJhc2UgdXNlcnMgZ2V0IGZ1bGwgYWNjZXNzXG4gICAgICB9O1xuXG4gICAgICAvLyBDcmVhdGUgc2Vzc2lvblxuICAgICAgY29uc3Qgc2Vzc2lvbjogQXV0aFNlc3Npb24gPSB7XG4gICAgICAgIGN1c3RvbWVySWQ6ICdTVVBBQkFTRV9VU0VSJyxcbiAgICAgICAgYWNjZXNzVG9rZW46ICdzdXBhYmFzZS1hdXRoJyxcbiAgICAgICAgcmVmcmVzaFRva2VuOiBgc3VwYWJhc2VfcmVmcmVzaF8ke0RhdGUubm93KCl9YCxcbiAgICAgICAgZXhwaXJlc0F0OiBEYXRlLm5vdygpICsgKDI0ICogNjAgKiA2MCAqIDEwMDApLCAvLyAyNCBob3Vyc1xuICAgICAgICBjdXN0b21lclxuICAgICAgfTtcblxuICAgICAgdGhpcy5zZXNzaW9uID0gc2Vzc2lvbjtcbiAgICAgIHRoaXMuc2F2ZVNlc3Npb25Ub1N0b3JhZ2Uoc2Vzc2lvbik7XG5cbiAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IGN1c3RvbWVyIH07XG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xuICAgICAgcmV0dXJuIHsgXG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLCBcbiAgICAgICAgZXJyb3I6ICdTdXBhYmFzZSBhdXRoZW50aWNhdGlvbiBmYWlsZWQuIFBsZWFzZSB0cnkgYWdhaW4uJyBcbiAgICAgIH07XG4gICAgfVxuICB9XG5cbiAgLy8gQ2hlY2sgaWYgdXNlciBpcyBhdXRoZW50aWNhdGVkIHZpYSBTdXBhYmFzZVxuICBhc3luYyBpc1N1cGFiYXNlQXV0aGVudGljYXRlZCgpOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgdXNlciA9IGF3YWl0IGdldFN1cGFiYXNlVXNlcigpO1xuICAgICAgcmV0dXJuICEhdXNlcjtcbiAgICB9IGNhdGNoIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH1cblxuICAvLyBFbmhhbmNlZCBsb2dpbiB3aXRoIG11bHRpcGxlIGF1dGhlbnRpY2F0aW9uIHBhdHRlcm5zXG4gIGFzeW5jIGxvZ2luKGN1c3RvbWVySWQ6IHN0cmluZywgYWNjZXNzVG9rZW4/OiBzdHJpbmcpOiBQcm9taXNlPHsgc3VjY2VzczogYm9vbGVhbjsgZGF0YT86IEN1c3RvbWVyUHJvZmlsZTsgZXJyb3I/OiBzdHJpbmcgfT4ge1xuICAgIHRyeSB7XG4gICAgICAvLyBTaW11bGF0ZSBBUEkgZGVsYXlcbiAgICAgIGF3YWl0IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCA1MDApKTtcbiAgICAgIFxuICAgICAgY29uc3QgY3VzdG9tZXIgPSB0aGlzLmdldEN1c3RvbWVyUHJvZmlsZShjdXN0b21lcklkKTtcbiAgICAgIGlmICghY3VzdG9tZXIpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICBlcnJvcjogJ0N1c3RvbWVyIG5vdCBmb3VuZC4gUGxlYXNlIGNoZWNrIHlvdXIgQ3VzdG9tZXIgSUQuJ1xuICAgICAgICB9O1xuICAgICAgfVxuXG4gICAgICAvLyBWYWxpZGF0ZSBhZG1pbiBhY2Nlc3MgdG9rZW5zXG4gICAgICBpZiAoY3VzdG9tZXIuaXNBZG1pbiAmJiBhY2Nlc3NUb2tlbikge1xuICAgICAgICBjb25zdCB2YWxpZEFkbWluVG9rZW5zID0gWydhZG1pbi1kZW1vLXRva2VuLTIwMjUnLCAndGVzdC10b2tlbi0xMjM0NTYnXTtcbiAgICAgICAgaWYgKCF2YWxpZEFkbWluVG9rZW5zLmluY2x1ZGVzKGFjY2Vzc1Rva2VuKSkge1xuICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgIGVycm9yOiAnSW52YWxpZCBhZG1pbiBhY2Nlc3MgdG9rZW4uJ1xuICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy8gQ3JlYXRlIHNlc3Npb25cbiAgICAgIGNvbnN0IHNlc3Npb246IEF1dGhTZXNzaW9uID0ge1xuICAgICAgICBjdXN0b21lcklkLFxuICAgICAgICBhY2Nlc3NUb2tlbjogYWNjZXNzVG9rZW4gfHwgYHRva2VuXyR7Y3VzdG9tZXJJZH1fJHtEYXRlLm5vdygpfWAsXG4gICAgICAgIHJlZnJlc2hUb2tlbjogYHJlZnJlc2hfJHtjdXN0b21lcklkfV8ke0RhdGUubm93KCl9YCxcbiAgICAgICAgZXhwaXJlc0F0OiBEYXRlLm5vdygpICsgKDI0ICogNjAgKiA2MCAqIDEwMDApLCAvLyAyNCBob3Vyc1xuICAgICAgICBjdXN0b21lclxuICAgICAgfTtcblxuICAgICAgdGhpcy5zZXNzaW9uID0gc2Vzc2lvbjtcbiAgICAgIHRoaXMuc2F2ZVNlc3Npb25Ub1N0b3JhZ2Uoc2Vzc2lvbik7XG5cbiAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IGN1c3RvbWVyIH07XG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xuICAgICAgcmV0dXJuIHsgXG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLCBcbiAgICAgICAgZXJyb3I6ICdMb2dpbiBmYWlsZWQuIFBsZWFzZSB0cnkgYWdhaW4uJyBcbiAgICAgIH07XG4gICAgfVxuICB9XG5cbiAgLy8gTG9nb3V0IGFuZCBjbGVhciBzZXNzaW9uXG4gIGxvZ291dCgpOiB2b2lkIHtcbiAgICB0aGlzLmNsZWFyU2Vzc2lvbigpO1xuICAgIGlmICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSAnL2xvZ2luJztcbiAgICB9XG4gIH1cblxuICAvLyBDaGVjayBpZiB1c2VyIGlzIGF1dGhlbnRpY2F0ZWRcbiAgaXNBdXRoZW50aWNhdGVkKCk6IGJvb2xlYW4ge1xuICAgIGlmICghdGhpcy5zZXNzaW9uKSByZXR1cm4gZmFsc2U7XG4gICAgaWYgKHRoaXMuc2Vzc2lvbi5leHBpcmVzQXQgPCBEYXRlLm5vdygpKSB7XG4gICAgICB0aGlzLmNsZWFyU2Vzc2lvbigpO1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuXG4gIC8vIEdldCBjdXJyZW50IHNlc3Npb25cbiAgZ2V0Q3VycmVudFNlc3Npb24oKTogQXV0aFNlc3Npb24gfCBudWxsIHtcbiAgICBpZiAoIXRoaXMuaXNBdXRoZW50aWNhdGVkKCkpIHJldHVybiBudWxsO1xuICAgIHJldHVybiB0aGlzLnNlc3Npb247XG4gIH1cblxuICAvLyBHZXQgY3VycmVudCBjdXN0b21lclxuICBnZXRDdXJyZW50Q3VzdG9tZXIoKTogQ3VzdG9tZXJQcm9maWxlIHwgbnVsbCB7XG4gICAgY29uc3Qgc2Vzc2lvbiA9IHRoaXMuZ2V0Q3VycmVudFNlc3Npb24oKTtcbiAgICByZXR1cm4gc2Vzc2lvbj8uY3VzdG9tZXIgfHwgbnVsbDtcbiAgfVxuXG4gIC8vIEdldCBjdXN0b21lciBJRFxuICBnZXRDdXN0b21lcklkKCk6IHN0cmluZyB8IHVuZGVmaW5lZCB7XG4gICAgY29uc3Qgc2Vzc2lvbiA9IHRoaXMuZ2V0Q3VycmVudFNlc3Npb24oKTtcbiAgICByZXR1cm4gc2Vzc2lvbj8uY3VzdG9tZXJJZDtcbiAgfVxuXG4gIC8vIEdldCBhY2Nlc3MgdG9rZW5cbiAgZ2V0QWNjZXNzVG9rZW4oKTogc3RyaW5nIHwgdW5kZWZpbmVkIHtcbiAgICBjb25zdCBzZXNzaW9uID0gdGhpcy5nZXRDdXJyZW50U2Vzc2lvbigpO1xuICAgIHJldHVybiBzZXNzaW9uPy5hY2Nlc3NUb2tlbjtcbiAgfVxuXG4gIC8vIEFkbWluIGFjY2VzcyBjaGVja3NcbiAgaXNBZG1pbigpOiBib29sZWFuIHtcbiAgICBjb25zdCBjdXN0b21lciA9IHRoaXMuZ2V0Q3VycmVudEN1c3RvbWVyKCk7XG4gICAgcmV0dXJuIGN1c3RvbWVyPy5pc0FkbWluID09PSB0cnVlO1xuICB9XG5cbiAgaGFzQWRtaW5BY2Nlc3MoKTogYm9vbGVhbiB7XG4gICAgY29uc3QgY3VzdG9tZXIgPSB0aGlzLmdldEN1cnJlbnRDdXN0b21lcigpO1xuICAgIHJldHVybiBjdXN0b21lcj8uaXNBZG1pbiA9PT0gdHJ1ZSAmJiBjdXN0b21lcj8uYWRtaW5BY2Nlc3MgPT09IHRydWU7XG4gIH1cblxuICAvLyBQYXltZW50IHN0YXR1cyBjaGVja3NcbiAgaGFzQ29tcGxldGVkUGF5bWVudCgpOiBib29sZWFuIHtcbiAgICBjb25zdCBjdXN0b21lciA9IHRoaXMuZ2V0Q3VycmVudEN1c3RvbWVyKCk7XG4gICAgLy8gQWRtaW4gdXNlcnMgYWx3YXlzIGhhdmUgYWNjZXNzXG4gICAgaWYgKGN1c3RvbWVyPy5pc0FkbWluKSByZXR1cm4gdHJ1ZTtcbiAgICByZXR1cm4gY3VzdG9tZXI/LnBheW1lbnRTdGF0dXMgPT09ICdDb21wbGV0ZWQnO1xuICB9XG5cbiAgLy8gVG9vbCBhY2Nlc3MgdmFsaWRhdGlvblxuICBoYXNUb29sQWNjZXNzKHRvb2xOYW1lOiBzdHJpbmcpOiBib29sZWFuIHtcbiAgICBjb25zdCBjdXN0b21lciA9IHRoaXMuZ2V0Q3VycmVudEN1c3RvbWVyKCk7XG4gICAgaWYgKCFjdXN0b21lcikgcmV0dXJuIGZhbHNlO1xuICAgIFxuICAgIC8vIEFkbWluIHVzZXJzIGhhdmUgYWNjZXNzIHRvIGFsbCB0b29sc1xuICAgIGlmIChjdXN0b21lci5pc0FkbWluKSByZXR1cm4gdHJ1ZTtcbiAgICBcbiAgICAvLyBDaGVjayBwYXltZW50IHN0YXR1cyBmb3IgcmVndWxhciB1c2Vyc1xuICAgIGlmICghdGhpcy5oYXNDb21wbGV0ZWRQYXltZW50KCkpIHJldHVybiBmYWxzZTtcbiAgICBcbiAgICAvLyBUb29sLXNwZWNpZmljIGFjY2VzcyBsb2dpY1xuICAgIHN3aXRjaCAodG9vbE5hbWUpIHtcbiAgICAgIGNhc2UgJ2ljcCc6XG4gICAgICAgIHJldHVybiBjdXN0b21lci5oYXNQZXJzb25hbGl6ZWRJQ1AgfHwgZmFsc2U7XG4gICAgICBjYXNlICdjb3N0LWNhbGN1bGF0b3InOlxuICAgICAgICByZXR1cm4gdHJ1ZTsgLy8gQXZhaWxhYmxlIHRvIGFsbCBwYWlkIHVzZXJzXG4gICAgICBjYXNlICdidXNpbmVzcy1jYXNlJzpcbiAgICAgICAgcmV0dXJuIGN1c3RvbWVyLmhhc0RldGFpbGVkQW5hbHlzaXMgfHwgZmFsc2U7XG4gICAgICBkZWZhdWx0OlxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICB9XG5cbiAgLy8gUmVmcmVzaCBhdXRoZW50aWNhdGlvbiB0b2tlblxuICBhc3luYyByZWZyZXNoVG9rZW4oKTogUHJvbWlzZTxib29sZWFuPiB7XG4gICAgaWYgKCF0aGlzLnNlc3Npb24pIHJldHVybiBmYWxzZTtcbiAgICBcbiAgICB0cnkge1xuICAgICAgLy8gU2ltdWxhdGUgdG9rZW4gcmVmcmVzaCBBUEkgY2FsbFxuICAgICAgY29uc3QgbmV3VG9rZW4gPSBgcmVmcmVzaGVkX3Rva2VuXyR7dGhpcy5zZXNzaW9uLmN1c3RvbWVySWR9XyR7RGF0ZS5ub3coKX1gO1xuICAgICAgdGhpcy5zZXNzaW9uLmFjY2Vzc1Rva2VuID0gbmV3VG9rZW47XG4gICAgICB0aGlzLnNlc3Npb24uZXhwaXJlc0F0ID0gRGF0ZS5ub3coKSArICgyNCAqIDYwICogNjAgKiAxMDAwKTtcbiAgICAgIFxuICAgICAgdGhpcy5zYXZlU2Vzc2lvblRvU3RvcmFnZSh0aGlzLnNlc3Npb24pO1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byByZWZyZXNoIHRva2VuOicsIGVycm9yKTtcbiAgICAgIHRoaXMuY2xlYXJTZXNzaW9uKCk7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICB9XG5cbiAgLy8gU2Vzc2lvbiB2YWxpZGF0aW9uIGFuZCBleHRlbnNpb25cbiAgYXN5bmMgdmFsaWRhdGVTZXNzaW9uKCk6IFByb21pc2U8Ym9vbGVhbj4ge1xuICAgIGlmICghdGhpcy5zZXNzaW9uKSByZXR1cm4gZmFsc2U7XG4gICAgXG4gICAgLy8gSWYgc2Vzc2lvbiBleHBpcmVzIGluIGxlc3MgdGhhbiAxIGhvdXIsIHRyeSB0byByZWZyZXNoXG4gICAgY29uc3Qgb25lSG91ciA9IDYwICogNjAgKiAxMDAwO1xuICAgIGlmICh0aGlzLnNlc3Npb24uZXhwaXJlc0F0IC0gRGF0ZS5ub3coKSA8IG9uZUhvdXIpIHtcbiAgICAgIHJldHVybiBhd2FpdCB0aGlzLnJlZnJlc2hUb2tlbigpO1xuICAgIH1cbiAgICBcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuXG4gIC8vIEdldCBjdXN0b21lciBwcm9maWxlcyAobW9jayBkYXRhKVxuICBwcml2YXRlIGdldEN1c3RvbWVyUHJvZmlsZShjdXN0b21lcklkOiBzdHJpbmcpOiBDdXN0b21lclByb2ZpbGUgfCBudWxsIHtcbiAgICBjb25zdCBwcm9maWxlczogUmVjb3JkPHN0cmluZywgQ3VzdG9tZXJQcm9maWxlPiA9IHtcbiAgICAgICdDVVNUXzInOiB7XG4gICAgICAgIGlkOiAnQ1VTVF8yJyxcbiAgICAgICAgY3VzdG9tZXJJZDogJ0NVU1RfMicsXG4gICAgICAgIG5hbWU6ICdKb2huIERlbW8nLFxuICAgICAgICBjdXN0b21lck5hbWU6ICdKb2huIERlbW8nLFxuICAgICAgICBlbWFpbDogJ2pvaG5AZXhhbXBsZS5jb20nLFxuICAgICAgICBjb21wYW55OiAnRGVtbyBDb21wYW55JyxcbiAgICAgICAgc3RhdHVzOiAnYWN0aXZlJyxcbiAgICAgICAgaXNBZG1pbjogZmFsc2UsXG4gICAgICAgIGRlbW9Nb2RlOiBmYWxzZSxcbiAgICAgICAgaGFzUGVyc29uYWxpemVkSUNQOiB0cnVlLFxuICAgICAgICBoYXNEZXRhaWxlZEFuYWx5c2lzOiBmYWxzZSxcbiAgICAgICAgcGF5bWVudFN0YXR1czogJ0NvbXBsZXRlZCdcbiAgICAgIH0sXG4gICAgICAnQ1VTVF80Jzoge1xuICAgICAgICBpZDogJ0NVU1RfNCcsXG4gICAgICAgIGN1c3RvbWVySWQ6ICdDVVNUXzQnLFxuICAgICAgICBuYW1lOiAnQWRtaW4gRGVtbycsXG4gICAgICAgIGN1c3RvbWVyTmFtZTogJ1BsYXRmb3JtIEFkbWluaXN0cmF0b3InLFxuICAgICAgICBlbWFpbDogJ2FkbWluQGV4YW1wbGUuY29tJyxcbiAgICAgICAgY29tcGFueTogJ0gmUyBSZXZlbnVlIEludGVsbGlnZW5jZScsXG4gICAgICAgIHN0YXR1czogJ2FkbWluJyxcbiAgICAgICAgaXNBZG1pbjogdHJ1ZSxcbiAgICAgICAgZGVtb01vZGU6IHRydWUsXG4gICAgICAgIGhhc1BlcnNvbmFsaXplZElDUDogdHJ1ZSxcbiAgICAgICAgaGFzRGV0YWlsZWRBbmFseXNpczogdHJ1ZSxcbiAgICAgICAgYWRtaW5BY2Nlc3M6IHRydWUsXG4gICAgICAgIHBheW1lbnRTdGF0dXM6ICdDb21wbGV0ZWQnXG4gICAgICB9LFxuICAgICAgJ2RydTc4RFI5Nzg5U0RGODYyJzoge1xuICAgICAgICBpZDogJ2RydTc4RFI5Nzg5U0RGODYyJyxcbiAgICAgICAgY3VzdG9tZXJJZDogJ2RydTc4RFI5Nzg5U0RGODYyJyxcbiAgICAgICAgbmFtZTogJ0dldGVyJyxcbiAgICAgICAgY3VzdG9tZXJOYW1lOiAnR2V0ZXInLFxuICAgICAgICBlbWFpbDogJ2dldGVyQGhzLXBsYXRmb3JtLmNvbScsXG4gICAgICAgIGNvbXBhbnk6ICdIJlMgUGxhdGZvcm0nLFxuICAgICAgICBzdGF0dXM6ICdhZG1pbicsXG4gICAgICAgIGlzQWRtaW46IHRydWUsXG4gICAgICAgIGRlbW9Nb2RlOiB0cnVlLFxuICAgICAgICBoYXNQZXJzb25hbGl6ZWRJQ1A6IHRydWUsXG4gICAgICAgIGhhc0RldGFpbGVkQW5hbHlzaXM6IHRydWUsXG4gICAgICAgIGFkbWluQWNjZXNzOiB0cnVlLFxuICAgICAgICBwYXltZW50U3RhdHVzOiAnQ29tcGxldGVkJ1xuICAgICAgfSxcbiAgICAgICdDVVNUXzAyJzoge1xuICAgICAgICBpZDogJ0NVU1RfMDInLFxuICAgICAgICBjdXN0b21lcklkOiAnQ1VTVF8wMicsXG4gICAgICAgIG5hbWU6ICdUZXN0IFVzZXInLFxuICAgICAgICBjdXN0b21lck5hbWU6ICdUZXN0IFVzZXInLFxuICAgICAgICBlbWFpbDogJ3Rlc3RAZXhhbXBsZS5jb20nLFxuICAgICAgICBjb21wYW55OiAnVGVzdCBDb21wYW55JyxcbiAgICAgICAgc3RhdHVzOiAndGVzdCcsXG4gICAgICAgIGlzQWRtaW46IGZhbHNlLFxuICAgICAgICBkZW1vTW9kZTogdHJ1ZSxcbiAgICAgICAgaGFzUGVyc29uYWxpemVkSUNQOiBmYWxzZSxcbiAgICAgICAgaGFzRGV0YWlsZWRBbmFseXNpczogZmFsc2UsXG4gICAgICAgIHBheW1lbnRTdGF0dXM6ICdQZW5kaW5nJ1xuICAgICAgfVxuICAgIH07XG5cbiAgICByZXR1cm4gcHJvZmlsZXNbY3VzdG9tZXJJZF0gfHwgbnVsbDtcbiAgfVxuXG4gIC8vIERldmVsb3BtZW50IHV0aWxpdGllc1xuICBpc0RlbW9Nb2RlKCk6IGJvb2xlYW4ge1xuICAgIGNvbnN0IGN1c3RvbWVyID0gdGhpcy5nZXRDdXJyZW50Q3VzdG9tZXIoKTtcbiAgICByZXR1cm4gY3VzdG9tZXI/LmRlbW9Nb2RlID09PSB0cnVlO1xuICB9XG5cbiAgZ2V0U2Vzc2lvbkluZm8oKTogYW55IHtcbiAgICByZXR1cm4ge1xuICAgICAgaXNBdXRoZW50aWNhdGVkOiB0aGlzLmlzQXV0aGVudGljYXRlZCgpLFxuICAgICAgY3VzdG9tZXJJZDogdGhpcy5nZXRDdXN0b21lcklkKCksXG4gICAgICBpc0FkbWluOiB0aGlzLmlzQWRtaW4oKSxcbiAgICAgIGhhc0FkbWluQWNjZXNzOiB0aGlzLmhhc0FkbWluQWNjZXNzKCksXG4gICAgICBoYXNDb21wbGV0ZWRQYXltZW50OiB0aGlzLmhhc0NvbXBsZXRlZFBheW1lbnQoKSxcbiAgICAgIGlzRGVtb01vZGU6IHRoaXMuaXNEZW1vTW9kZSgpLFxuICAgICAgc2Vzc2lvbkV4cGlyZXNBdDogdGhpcy5zZXNzaW9uPy5leHBpcmVzQXQsXG4gICAgICBzZXNzaW9uVmFsaWQ6IHRoaXMuc2Vzc2lvbiA/IHRoaXMuc2Vzc2lvbi5leHBpcmVzQXQgPiBEYXRlLm5vdygpIDogZmFsc2VcbiAgICB9O1xuICB9XG5cbiAgLy8gRXh0cmFjdCBjcmVkZW50aWFscyBmcm9tIFVSTCBwYXJhbWV0ZXJzXG4gIGV4dHJhY3RDcmVkZW50aWFscyhzZWFyY2hQYXJhbXM6IFVSTFNlYXJjaFBhcmFtcyk6IHsgY3VzdG9tZXJJZDogc3RyaW5nOyBhY2Nlc3NUb2tlbjogc3RyaW5nIH0gfCBudWxsIHtcbiAgICBjb25zdCBjdXN0b21lcklkID0gc2VhcmNoUGFyYW1zLmdldCgnY3VzdG9tZXJJZCcpIHx8ICcnO1xuICAgIGNvbnN0IGFjY2Vzc1Rva2VuID0gc2VhcmNoUGFyYW1zLmdldCgndG9rZW4nKSB8fCAnJztcbiAgICBcbiAgICBpZiAoIWN1c3RvbWVySWQgfHwgIWFjY2Vzc1Rva2VuKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIHsgY3VzdG9tZXJJZCwgYWNjZXNzVG9rZW4gfTtcbiAgfVxuXG4gIC8vIFZhbGlkYXRlIGNyZWRlbnRpYWxzIHVzaW5nIGV4aXN0aW5nIGF1dGhlbnRpY2F0aW9uIGxvZ2ljXG4gIGFzeW5jIHZhbGlkYXRlQ3JlZGVudGlhbHMoY3VzdG9tZXJJZDogc3RyaW5nLCBhY2Nlc3NUb2tlbjogc3RyaW5nKTogUHJvbWlzZTx7IHZhbGlkOiBib29sZWFuOyBjdXN0b21lckRhdGE/OiBhbnk7IGVycm9yPzogc3RyaW5nIH0+IHtcbiAgICB0cnkge1xuICAgICAgLy8gVXNlIGV4aXN0aW5nIGF1dGhlbnRpY2F0aW9uIG1ldGhvZCBmb3IgYWRtaW4gdXNlcnNcbiAgICAgIGlmIChjdXN0b21lcklkID09PSAnZHJ1NzhEUjk3ODlTREY4NjInICYmIGFjY2Vzc1Rva2VuID09PSAnYWRtaW4tZGVtby10b2tlbi0yMDI1Jykge1xuICAgICAgICBjb25zdCBhZG1pbkRhdGEgPSBhd2FpdCB0aGlzLmdldEFkbWluUHJvZmlsZSgpO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHZhbGlkOiB0cnVlLFxuICAgICAgICAgIGN1c3RvbWVyRGF0YTogYWRtaW5EYXRhXG4gICAgICAgIH07XG4gICAgICB9XG5cbiAgICAgIC8vIEZvciByZWd1bGFyIGN1c3RvbWVycywgaW1wbGVtZW50IHByb3BlciB2YWxpZGF0aW9uXG4gICAgICAvLyBUaGlzIHdvdWxkIG5lZWQgaW50ZWdyYXRpb24gd2l0aCBhY3R1YWwgY3VzdG9tZXIgZGF0YWJhc2VcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHZhbGlkOiBmYWxzZSxcbiAgICAgICAgZXJyb3I6ICdDdXN0b21lciB2YWxpZGF0aW9uIG5vdCBpbXBsZW1lbnRlZCBmb3Igbm9uLWFkbWluIHVzZXJzJ1xuICAgICAgfTtcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB2YWxpZDogZmFsc2UsXG4gICAgICAgIGVycm9yOiBgVmFsaWRhdGlvbiBmYWlsZWQ6ICR7ZXJyb3IubWVzc2FnZX1gXG4gICAgICB9O1xuICAgIH1cbiAgfVxuXG4gIC8vIEdlbmVyYXRlIHNlc3Npb24gZnJvbSB2YWxpZGF0ZWQgY3JlZGVudGlhbHNcbiAgYXN5bmMgZ2VuZXJhdGVTZXNzaW9uKGN1c3RvbWVySWQ6IHN0cmluZywgY3VzdG9tZXJEYXRhOiBhbnkpOiBQcm9taXNlPGFueT4ge1xuICAgIGNvbnN0IHNlc3Npb25EYXRhOiBBdXRoU2Vzc2lvbiA9IHtcbiAgICAgIGN1c3RvbWVySWQsXG4gICAgICBhY2Nlc3NUb2tlbjogYHRva2VuXyR7RGF0ZS5ub3coKX1gLFxuICAgICAgcmVmcmVzaFRva2VuOiBgcmVmcmVzaF8ke0RhdGUubm93KCl9YCxcbiAgICAgIGV4cGlyZXNBdDogRGF0ZS5ub3coKSArICgyNCAqIDYwICogNjAgKiAxMDAwKSwgLy8gMjQgaG91cnNcbiAgICAgIGN1c3RvbWVyOiBjdXN0b21lckRhdGFcbiAgICB9O1xuICAgIFxuICAgIHRoaXMuc2Vzc2lvbiA9IHNlc3Npb25EYXRhO1xuICAgIHRoaXMuc2F2ZVNlc3Npb25Ub1N0b3JhZ2UoKTtcbiAgICBcbiAgICByZXR1cm4gc2Vzc2lvbkRhdGE7XG4gIH1cblxuICAvLyBSZWZyZXNoIGV4aXN0aW5nIHNlc3Npb25cbiAgYXN5bmMgcmVmcmVzaFNlc3Npb24oKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgaWYgKHRoaXMuc2Vzc2lvbiAmJiB0aGlzLnNlc3Npb24uZXhwaXJlc0F0ID4gRGF0ZS5ub3coKSkge1xuICAgICAgdGhpcy5zZXNzaW9uLmV4cGlyZXNBdCA9IERhdGUubm93KCkgKyAoMjQgKiA2MCAqIDYwICogMTAwMCk7IC8vIEV4dGVuZCBieSAyNCBob3Vyc1xuICAgICAgdGhpcy5zYXZlU2Vzc2lvblRvU3RvcmFnZSgpO1xuICAgIH1cbiAgfVxufVxuXG4vLyBFeHBvcnQgc2luZ2xldG9uIGluc3RhbmNlXG5leHBvcnQgY29uc3QgYXV0aFNlcnZpY2UgPSBuZXcgQXV0aFNlcnZpY2UoKTtcbmV4cG9ydCBkZWZhdWx0IGF1dGhTZXJ2aWNlOyJdLCJuYW1lcyI6WyJDb29raWVzIiwiZ2V0Q3VycmVudFVzZXIiLCJnZXRTdXBhYmFzZVVzZXIiLCJBdXRoU2VydmljZSIsInNlc3Npb24iLCJUT0tFTl9DT09LSUUiLCJSRUZSRVNIX0NPT0tJRSIsIkNVU1RPTUVSX0lEX0NPT0tJRSIsIlNFU1NJT05fQ09PS0lFIiwiaW5zdGFuY2UiLCJsb2FkU2Vzc2lvbkZyb21TdG9yYWdlIiwic2Vzc2lvbkRhdGEiLCJnZXQiLCJKU09OIiwicGFyc2UiLCJleHBpcmVzQXQiLCJEYXRlIiwibm93IiwiY2xlYXJTZXNzaW9uIiwiZXJyb3IiLCJjb25zb2xlIiwid2FybiIsInNhdmVTZXNzaW9uVG9TdG9yYWdlIiwic2V0IiwiYWNjZXNzVG9rZW4iLCJleHBpcmVzIiwicmVmcmVzaFRva2VuIiwiY3VzdG9tZXJJZCIsInN0cmluZ2lmeSIsInJlbW92ZSIsImxvZ2luV2l0aFN1cGFiYXNlIiwic3VwYWJhc2VVc2VyIiwic3VjY2VzcyIsImN1c3RvbWVyIiwiaWQiLCJuYW1lIiwidXNlcl9tZXRhZGF0YSIsImZ1bGxfbmFtZSIsImVtYWlsIiwiY3VzdG9tZXJOYW1lIiwiY29tcGFueSIsInN0YXR1cyIsImlzQWRtaW4iLCJkZW1vTW9kZSIsImhhc1BlcnNvbmFsaXplZElDUCIsImhhc0RldGFpbGVkQW5hbHlzaXMiLCJwYXltZW50U3RhdHVzIiwiZGF0YSIsImlzU3VwYWJhc2VBdXRoZW50aWNhdGVkIiwidXNlciIsImxvZ2luIiwiUHJvbWlzZSIsInJlc29sdmUiLCJzZXRUaW1lb3V0IiwiZ2V0Q3VzdG9tZXJQcm9maWxlIiwidmFsaWRBZG1pblRva2VucyIsImluY2x1ZGVzIiwibG9nb3V0Iiwid2luZG93IiwibG9jYXRpb24iLCJocmVmIiwiaXNBdXRoZW50aWNhdGVkIiwiZ2V0Q3VycmVudFNlc3Npb24iLCJnZXRDdXJyZW50Q3VzdG9tZXIiLCJnZXRDdXN0b21lcklkIiwiZ2V0QWNjZXNzVG9rZW4iLCJoYXNBZG1pbkFjY2VzcyIsImFkbWluQWNjZXNzIiwiaGFzQ29tcGxldGVkUGF5bWVudCIsImhhc1Rvb2xBY2Nlc3MiLCJ0b29sTmFtZSIsIm5ld1Rva2VuIiwidmFsaWRhdGVTZXNzaW9uIiwib25lSG91ciIsInByb2ZpbGVzIiwiaXNEZW1vTW9kZSIsImdldFNlc3Npb25JbmZvIiwic2Vzc2lvbkV4cGlyZXNBdCIsInNlc3Npb25WYWxpZCIsImV4dHJhY3RDcmVkZW50aWFscyIsInNlYXJjaFBhcmFtcyIsInZhbGlkYXRlQ3JlZGVudGlhbHMiLCJhZG1pbkRhdGEiLCJnZXRBZG1pblByb2ZpbGUiLCJ2YWxpZCIsImN1c3RvbWVyRGF0YSIsIm1lc3NhZ2UiLCJnZW5lcmF0ZVNlc3Npb24iLCJyZWZyZXNoU2Vzc2lvbiIsImF1dGhTZXJ2aWNlIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./lib/services/authService.ts\n");

/***/ })

};
;