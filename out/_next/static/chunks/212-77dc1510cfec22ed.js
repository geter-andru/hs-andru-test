"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[212],{6110:(e,t,s)=>{s.d(t,{h:()=>o});var r=s(6414),a=s(2844);let o={async isAuthenticated(){try{let{data:{session:e},error:t}=await r.ND.auth.getSession();if(!t&&e)return!0;return a.auth.isAuthenticated()}catch(e){return console.error("Auth check failed:",e),!1}},async getCustomerId(){try{let{data:{session:e},error:t}=await r.ND.auth.getSession();if(!t&&(null==e?void 0:e.user))return"druSUPA8888BASE1";return a.auth.getCustomerId()}catch(e){return console.error("Failed to get customer ID:",e),null}},async getCurrentUser(){try{let{data:{session:t},error:s}=await r.ND.auth.getSession();if(!s&&(null==t?void 0:t.user)){var e;return{id:"druSUPA8888BASE1",email:t.user.email,name:(null==(e=t.user.user_metadata)?void 0:e.name)||t.user.email,isSupabaseUser:!0}}return a.auth.getCurrentCustomer()}catch(e){return console.error("Failed to get current user:",e),null}}}},6414:(e,t,s)=>{s.d(t,{HW:()=>c,ND:()=>n});var r=s(2354);let a="https://molcqjsqtjbfclasynpg.supabase.co",o="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im1vbGNxanNxdGpiZmNsYXN5bnBnIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTU4ODk1NDcsImV4cCI6MjA3MTQ2NTU0N30.IEP7E2VM2uV1vltbSw1CwYpYw1qw6MvI-JB5SD0tUKI";if(!a||!o)throw Error("Missing Supabase environment variables. Please check your .env.local file.");let n=(0,r.UU)(a,o,{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,debug:!1}}),c=async()=>{try{let{data:{user:e},error:t}=await n.auth.getUser();if(t)throw t;return e}catch(e){return console.error("Error getting current user:",e),null}}},8416:(e,t,s)=>{s.d(t,{A:()=>a});class r{async initialize(){try{return this.isConnected=window.mcpTools,this.isConnected||console.warn("Puppeteer MCP not available - running in fallback mode"),this.sessionId="puppeteer_session_".concat(Date.now()),{success:!0,sessionId:this.sessionId}}catch(e){return console.error("Puppeteer integration failed:",e),{success:!1,error:e.message}}}async navigate(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{waitFor:s,timeout:r=3e4,retries:a=3}=t;if(!this.isConnected)return this.fallbackNavigation(e);for(let t=1;t<=a;t++)try{let a=await this.callMCPTool("puppeteer_navigate",{url:e,waitFor:s,timeout:r});return{success:!0,url:a.finalUrl||e,timestamp:new Date().toISOString(),attempt:t}}catch(s){if(console.warn("Navigation attempt ".concat(t," failed:"),s.message),t===a)return this.errorCache.set(e,s.message),{success:!1,error:s.message,fallback:await this.fallbackNavigation(e)};await new Promise(e=>setTimeout(e,1e3*t))}}async captureScreenshot(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{selector:t,fullPage:s=!0,filename:r,storeLocal:a=!0}=e;if(!this.isConnected)return this.fallbackScreenshot();try{var o,n,c;let e=await this.callMCPTool("puppeteer_screenshot",{selector:t,fullPage:s,filename:r}),i={id:"screenshot_".concat(Date.now()),data:null==(o=e.metadata)?void 0:o.screenshot,url:null==(n=e.metadata)?void 0:n.url,timestamp:null==(c=e.metadata)?void 0:c.timestamp,selector:t,filename:r};return a&&this.screenshotStore.set(i.id,i),{success:!0,screenshot:i}}catch(e){return console.error("Screenshot capture failed:",e),{success:!1,error:e.message,fallback:await this.fallbackScreenshot()}}}async extractData(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{attribute:s,multiple:r=!1,parseAs:a="text"}=t;if(!this.isConnected)return this.fallbackDataExtraction(e);try{var o,n;let t=await this.callMCPTool("puppeteer_extract_data",{selector:e,attribute:s,multiple:r}),c=null==(o=t.metadata)?void 0:o.data;if("json"===a&&"string"==typeof c)try{c=JSON.parse(c)}catch(e){console.warn("Failed to parse as JSON, returning as text")}return{success:!0,data:c,selector:e,url:null==(n=t.metadata)?void 0:n.url,timestamp:new Date().toISOString()}}catch(t){return console.error("Data extraction failed:",t),{success:!1,error:t.message,fallback:await this.fallbackDataExtraction(e)}}}async researchCompetitor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"pricing",s={domain:e,type:t,timestamp:new Date().toISOString(),data:{},screenshots:[]};try{await this.navigate("https://".concat(e));let r=await this.captureScreenshot({filename:"".concat(e,"_homepage"),fullPage:!0});switch(s.screenshots.push(r.screenshot),t){case"pricing":s.data=await this.extractPricingInformation(e);break;case"features":s.data=await this.extractFeatureInformation(e);break;case"tech_stack":s.data=await this.extractTechStackInformation(e);break;default:s.data=await this.extractGeneralInformation(e)}return{success:!0,research:s}}catch(e){return console.error("Competitor research failed:",e),{success:!1,error:e.message,partialData:s}}}async extractPricingInformation(e){for(let s of['[class*="pricing"]','[class*="price"]','[id*="pricing"]','a[href*="pricing"]','a[href*="plans"]'])try{var t;let r=await this.extractData(s,{multiple:!0});if(r.success&&(null==(t=r.data)?void 0:t.length)>0&&r.data.find(e=>e.includes("/pricing")||e.includes("/plans"))){await this.interact("click",s),await new Promise(e=>setTimeout(e,3e3));let t=await this.captureScreenshot({filename:"".concat(e,"_pricing"),fullPage:!0}),r=await this.extractData('[class*="price"], [class*="cost"]',{multiple:!0});return{pricingPage:!0,prices:r.data,screenshot:t.screenshot}}}catch(e){console.warn("Failed to extract pricing with selector ".concat(s,":"),e);continue}return{pricingPage:!1,message:"No pricing information found on homepage"}}async extractFeatureInformation(e){let t=[];for(let e of['[class*="feature"]','[class*="benefit"]',"h1, h2, h3",'[class*="highlight"]'])try{var s;let r=await this.extractData(e,{multiple:!0});r.success&&(null==(s=r.data)?void 0:s.length)>0&&t.push(...r.data.filter(e=>e&&e.length>10))}catch(t){console.warn("Feature extraction failed for ".concat(e,":"),t)}return{features:t.slice(0,20),totalFound:t.length}}async extractTechStackInformation(e){try{var t;return{detectedTechnologies:(null==(t=(await this.executeJS("\n        // Common technology detection\n        const technologies = [];\n        \n        // Framework detection\n        if (window.React) technologies.push('React');\n        if (window.Vue) technologies.push('Vue.js');\n        if (window.angular) technologies.push('Angular');\n        if (window.jQuery) technologies.push('jQuery');\n        \n        // Analytics detection\n        if (window.gtag || window.ga) technologies.push('Google Analytics');\n        if (window.fbq) technologies.push('Facebook Pixel');\n        \n        // Other detections\n        const scripts = Array.from(document.querySelectorAll('script[src]'));\n        scripts.forEach(script => {\n          const src = script.src.toLowerCase();\n          if (src.includes('stripe')) technologies.push('Stripe');\n          if (src.includes('intercom')) technologies.push('Intercom');\n          if (src.includes('hotjar')) technologies.push('Hotjar');\n          if (src.includes('segment')) technologies.push('Segment');\n        });\n        \n        return technologies;\n      ")).metadata)?void 0:t.result)||[],method:"JavaScript detection"}}catch(e){return{error:e.message,detectedTechnologies:[],method:"Detection failed"}}}async fallbackNavigation(e){return{success:!1,method:"fallback",message:"Puppeteer MCP unavailable - would need manual research",suggestedAction:"Manually visit ".concat(e," for research")}}async fallbackScreenshot(){return{success:!1,method:"fallback",message:"Screenshot capture unavailable - MCP not connected"}}async fallbackDataExtraction(e){return{success:!1,method:"fallback",message:"Data extraction unavailable - would target: ".concat(e)}}async callMCPTool(e,t){if(!this.isConnected||!window.mcpTools)throw Error("MCP tools not available");throw Error("MCP integration pending - Claude Code setup required")}getStoredScreenshots(){return Array.from(this.screenshotStore.values())}getScreenshot(e){return this.screenshotStore.get(e)}clearScreenshots(){this.screenshotStore.clear()}getErrorHistory(){return Array.from(this.errorCache.entries()).map(e=>{let[t,s]=e;return{url:t,error:s,timestamp:new Date().toISOString()}})}clearErrors(){this.errorCache.clear()}async healthCheck(){return{connected:this.isConnected,sessionId:this.sessionId,screenshotCount:this.screenshotStore.size,errorCount:this.errorCache.size,status:this.isConnected?"operational":"fallback_mode"}}constructor(){this.isConnected=!1,this.sessionId=null,this.screenshotStore=new Map,this.errorCache=new Map}}let a=r},9226:(e,t,s)=>{s.d(t,{O:()=>m});var r=s(3464);let a="https://api.airtable.com/v0",o="app0jJkgTCqn46vp9",n="pat5kFmJsBxfL5Yqr.f44840b8b82995ec43ac998191c43f19d0471c9550d0fea9e0327cc4f4aa4815",c=new Map,i=new Map,l={icp_completed:!1,icp_score:null,cost_calculated:!1,annual_cost:null,business_case_ready:!1,selected_template:null,last_active_tool:"icp",completion_percentage:0,company_name:"",analysis_date:null},u={icp_framework_customized:!1,preferred_export_format:"pdf",methodology_transparency:!1,custom_criteria:[],export_history:[]},h={session_start:null,time_per_tool:{},export_count:0,share_count:0,tools_completed:[],last_login:null},p={overall_level:"Foundation",total_progress_points:0,competency_scores:{customer_analysis:0,business_communication:0,revenue_strategy:0,value_articulation:0,strategic_thinking:0},level_history:[],advancement_dates:{},consistency_streak:0,last_activity:null,competency_tier:"Foundation",development_points:0,next_tier_threshold:500},d={icp_analysis:{access:!0,completions:0,average_score:0,total_time_spent:0,best_score:0,completion_history:[]},cost_calculator:{access:!1,unlock_progress:{analyses_needed:3,score_needed:70,current_analyses:0,current_avg_score:0},completions:0,average_impact:0,completion_history:[]},business_case_builder:{access:!1,unlock_progress:{calculations_needed:2,impact_threshold:1e5,current_calculations:0,current_max_impact:0},completions:0,completion_quality:0,completion_history:[]}},m={isConfigured:()=>!!(o&&n),async getCustomerAssets(e,t){let s="".concat(e,"_").concat(t),i=c.get(s);if(i&&Date.now()-i.timestamp<3e5)return console.log("\uD83D\uDCCB Returning cached customer assets for:",e),i.data;if(!this.isConfigured())throw Error("Airtable not configured - missing BASE_ID or API_KEY");try{console.log("\uD83D\uDD0D Fetching customer assets from Airtable for:",e);let t=await r.A.get("".concat(a,"/").concat(o,"/Customer%20Assets"),{headers:{Authorization:"Bearer ".concat(n),"Content-Type":"application/json"},params:{filterByFormula:"{Customer ID} = '".concat(e,"'"),maxRecords:1}});if(0===t.data.records.length)throw Error("Customer not found: ".concat(e));let i=t.data.records[0],l=this.parseCustomerRecord(i);return c.set(s,{data:l,timestamp:Date.now()}),console.log("✅ Successfully fetched customer assets for:",e),l}catch(e){throw console.error("❌ Error fetching customer assets:",e.message),Error("Failed to fetch customer data: ".concat(e.message))}},parseCustomerRecord(e){let t=e.fields;return{customerId:t["Customer ID"]||"",customerName:t["Customer Name"]||"",companyName:t["Company Name"]||"",email:t.Email||"",workflowProgress:this.parseJSON(t["Workflow Progress"],l),userPreferences:this.parseJSON(t["User Preferences"],u),usageAnalytics:this.parseJSON(t["Usage Analytics"],h),competencyProgress:this.parseJSON(t["Competency Progress"],p),toolAccessStatus:this.parseJSON(t["Tool Access Status"],d),professionalMilestones:this.parseJSON(t["Professional Milestones"],{}),dailyObjectives:this.parseJSON(t["Daily Objectives"],{}),detailedIcpAnalysis:this.parseJSON(t["detailed ICP analysis"],{}),targetBuyerPersonas:this.parseJSON(t["target buyer personas"],{}),empathyMapping:this.parseJSON(t["empathy mapping"],{}),productAssessment:this.parseJSON(t["product assessment"],{}),exportHistory:this.parseJSON(t["Export History"],[]),createdAt:t["Created At"]||new Date().toISOString(),lastUpdated:t["Last Updated"]||new Date().toISOString()}},parseJSON(e,t){if(!e)return t;try{if("string"==typeof e)return JSON.parse(e);return e}catch(e){return console.warn("Failed to parse JSON field:",e),t}},async updateCustomerAssets(e,t){if(!this.isConfigured())return{success:!1,error:"Airtable not configured"};try{let s=await r.A.get("".concat(a,"/").concat(o,"/Customer%20Assets"),{headers:{Authorization:"Bearer ".concat(n),"Content-Type":"application/json"},params:{filterByFormula:"{Customer ID} = '".concat(e,"'"),maxRecords:1}});if(0===s.data.records.length)return{success:!1,error:"Customer not found: ".concat(e)};let i=s.data.records[0].id,l={};return t.workflowProgress&&(l["Workflow Progress"]=JSON.stringify(t.workflowProgress)),t.competencyProgress&&(l["Competency Progress"]=JSON.stringify(t.competencyProgress)),t.toolAccessStatus&&(l["Tool Access Status"]=JSON.stringify(t.toolAccessStatus)),l["Last Updated"]=new Date().toISOString(),await r.A.patch("".concat(a,"/").concat(o,"/Customer%20Assets/").concat(i),{fields:l},{headers:{Authorization:"Bearer ".concat(n),"Content-Type":"application/json"}}),Array.from(c.keys()).filter(t=>t.startsWith(e)).forEach(e=>c.delete(e)),console.log("✅ Successfully updated customer assets for:",e),{success:!0}}catch(e){return console.error("❌ Error updating customer assets:",e.message),{success:!1,error:e.message}}},async syncGeneratedResourcesToAirtable(e,t){if(!this.isConfigured())return{success:!1,error:"Airtable not configured"};try{let s={},i=[];if(t.icp_analysis&&(s["detailed ICP analysis"]=JSON.stringify(t.icp_analysis),i.push("detailed ICP analysis")),t.buyer_personas&&(s["target buyer personas"]=JSON.stringify(t.buyer_personas),i.push("target buyer personas")),t.empathy_map&&(s["empathy mapping"]=JSON.stringify(t.empathy_map),i.push("empathy mapping")),t.product_assessment||t.product_market_potential){let e=t.product_assessment||t.product_market_potential;s["product assessment"]=JSON.stringify(e),i.push("product assessment")}s["Last Updated"]=new Date().toISOString();let l=await r.A.get("".concat(a,"/").concat(o,"/Customer%20Assets"),{headers:{Authorization:"Bearer ".concat(n),"Content-Type":"application/json"},params:{filterByFormula:"{Customer ID} = '".concat(e,"'"),maxRecords:1}});if(0===l.data.records.length)return{success:!1,error:"Customer not found: ".concat(e)};let u=l.data.records[0].id;return await r.A.patch("".concat(a,"/").concat(o,"/Customer%20Assets/").concat(u),{fields:s},{headers:{Authorization:"Bearer ".concat(n),"Content-Type":"application/json"}}),Array.from(c.keys()).filter(t=>t.startsWith(e)).forEach(e=>c.delete(e)),console.log("✅ Successfully synced resources to Airtable for:",e),{success:!0,updatedFields:i}}catch(e){return console.error("❌ Error syncing resources to Airtable:",e.message),{success:!1,error:e.message}}},clearCache(){c.clear(),i.clear(),console.log("\uD83E\uDDF9 Cleared Airtable service cache")},getCustomerByEmail:async e=>(console.log("\uD83D\uDD0D Looking up customer by email:",e),null),createCustomer:async e=>(console.log("\uD83D\uDC64 Creating new customer:",e.email),{customerId:"MOCK_"+Date.now(),...e}),storeICPAnalysisProof:async(e,t)=>(console.log("\uD83D\uDCCA Storing ICP analysis proof for:",e),{success:!0,research:{data:t}}),storeCompetitorResearchProof:async(e,t)=>(console.log("\uD83D\uDD0D Storing competitor research proof for:",e),{success:!0,research:{data:t}})}}}]);